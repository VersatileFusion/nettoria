<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="keywords" content="Nettoria,نتوریا,VPS,سرور مجازی" />
  <title>Blogs - Nettoria</title>
  <link rel="stylesheet" href="./Assets/css/style.css" />
  <link rel="stylesheet" href="./Assets/css/common.css" />
  <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
  <link rel="shortcut icon" href="./Assets/img/icon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
  <div class="container">
    <header>
      <nav>
        <div class="logo">
          <img src="Assets/images/logo.png" alt="Nettoria Logo">
        </div>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="services.html">Services</a></li>
          <li><a href="blogs.html" class="active">Blogs</a></li>
          <li><a href="about-us.html">About Us</a></li>
          <li><a href="Contact-us.html">Contact</a></li>
        </ul>
        <div class="auth-buttons">
          <a href="login.html" class="btn btn-login">Login</a>
          <a href="signup.html" class="btn btn-signup">Sign Up</a>
        </div>
      </nav>
    </header>

    <main>
      <section class="blog-header">
        <h1>Latest Blog Posts</h1>
        <div class="blog-filters">
          <select id="categoryFilter">
            <option value="">All Categories</option>
            <option value="technology">Technology</option>
            <option value="cloud">Cloud Computing</option>
            <option value="security">Security</option>
            <option value="tutorials">Tutorials</option>
          </select>
          <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search blogs...">
            <button id="searchButton"><i class="fas fa-search"></i></button>
          </div>
        </div>
      </section>

      <section class="blog-grid" id="blogGrid">
        <!-- Blog posts will be dynamically loaded here -->
      </section>

      <div class="pagination" id="pagination">
        <!-- Pagination will be dynamically loaded here -->
      </div>
    </main>

    <footer>
      <div class="footer-content">
        <div class="footer-section">
          <h3>About Nettoria</h3>
          <p>Your trusted partner in cloud computing and hosting solutions.</p>
        </div>
        <div class="footer-section">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="services.html">Services</a></li>
            <li><a href="blogs.html">Blogs</a></li>
            <li><a href="about-us.html">About Us</a></li>
            <li><a href="Contact-us.html">Contact</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Contact Us</h3>
          <p>Email: info@nettoria.com</p>
          <p>Phone: +1 234 567 890</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2024 Nettoria. All rights reserved.</p>
      </div>
    </footer>
  </div>

  <script>
    // API Configuration
    const API_BASE_URL = '/api';
    let currentPage = 1;
    const itemsPerPage = 9;

    // DOM Elements
    const blogGrid = document.getElementById('blogGrid');
    const pagination = document.getElementById('pagination');
    const categoryFilter = document.getElementById('categoryFilter');
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');

    // Fetch blogs with pagination and filters
    async function fetchBlogs(page = 1, category = '', search = '') {
      try {
        const queryParams = new URLSearchParams({
          page,
          limit: itemsPerPage,
          ...(category && { category }),
          ...(search && { search })
        });

        const response = await fetch(`${API_BASE_URL}/blogs?${queryParams}`);
        const data = await response.json();

        if (data.success) {
          renderBlogs(data.data.blogs);
          renderPagination(data.data.pagination);
        } else {
          showError('Failed to fetch blogs');
        }
      } catch (error) {
        console.error('Error fetching blogs:', error);
        showError('Failed to fetch blogs');
      }
    }

    // Render blog posts
    function renderBlogs(blogs) {
      blogGrid.innerHTML = blogs.map(blog => `
          <article class="blog-card">
            <div class="blog-image">
              <img src="${blog.image || 'Assets/images/blog-placeholder.jpg'}" alt="${blog.title}">
            </div>
            <div class="blog-content">
              <div class="blog-category">${blog.category}</div>
              <h2 class="blog-title">${blog.title}</h2>
              <p class="blog-excerpt">${blog.content.substring(0, 150)}...</p>
              <div class="blog-meta">
                <span class="blog-date">${new Date(blog.createdAt).toLocaleDateString()}</span>
                <a href="blog-post.html?id=${blog.id}" class="read-more">Read More</a>
              </div>
            </div>
          </article>
        `).join('');
    }

    // Render pagination
    function renderPagination({ total, page, pages }) {
      pagination.innerHTML = `
          <button class="pagination-btn" ${page === 1 ? 'disabled' : ''} onclick="changePage(${page - 1})">
            <i class="fas fa-chevron-left"></i>
          </button>
          <span class="page-info">Page ${page} of ${pages}</span>
          <button class="pagination-btn" ${page === pages ? 'disabled' : ''} onclick="changePage(${page + 1})">
            <i class="fas fa-chevron-right"></i>
          </button>
        `;
    }

    // Change page
    function changePage(page) {
      currentPage = page;
      fetchBlogs(page, categoryFilter.value, searchInput.value);
    }

    // Show error message
    function showError(message) {
      blogGrid.innerHTML = `
          <div class="error-message">
            <i class="fas fa-exclamation-circle"></i>
            <p>${message}</p>
          </div>
        `;
    }

    // Event Listeners
    categoryFilter.addEventListener('change', () => {
      currentPage = 1;
      fetchBlogs(1, categoryFilter.value, searchInput.value);
    });

    searchButton.addEventListener('click', () => {
      currentPage = 1;
      fetchBlogs(1, categoryFilter.value, searchInput.value);
    });

    searchInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        currentPage = 1;
        fetchBlogs(1, categoryFilter.value, searchInput.value);
      }
    });

    // Initial load
    fetchBlogs();
  </script>
</body>

</html>